apply from: "${rootDir}/gradle/mwe2-workflows.gradle"

dependencies {
	// We cannot use the projects within the workspace, as we would have
	// to compile them before generating the code, so we need to stick to the bootstrapping version.
	// Buildship, however, links the workspace projects anyway if a composite build is used.
	compile "org.eclipse.xtext:org.eclipse.xtext:$versions.xtext_bootstrap"
	compile "org.eclipse.xtext:org.eclipse.xtext.xtext.generator:$versions.xtext_bootstrap"
}

sourceSets.main.java.srcDirs = []

sourceSets.mwe2 {
	java.srcDir 'src'
	if (findProperty('compileXtend') == 'true') {
		xtendOutputDir = 'xtend-gen'
	} else {
		java.srcDir 'xtend-gen'
	}
}
configurations.mwe2Compile.extendsFrom configurations.compile
jar.from sourceSets.mwe2.output
sourcesJar.from sourceSets.mwe2.allSource

task generateXtextLanguage(type: XtextGeneratorTask) {
	workflow = file('src/org/eclipse/xtext/xtext/bootstrap/GenerateXtext.mwe2')
}
